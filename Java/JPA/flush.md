- [flush](#flush)
  - [영속성 컨텍스트를 플러시하는 방법](#영속성-컨텍스트를-플러시하는-방법)
  - [플러시 모드](#플러시-모드)

# flush

영속성 컨텍스트의 변경내용을 데이터베이스에 반영하는 것 ( 영속성 컨텍스트를 비우는 것이 아니다 )

트랜잭션 단위로 동작하기 때문에 트랜잭션 작업 단위가 중요하다

플러시가 발생하면

→ 변경 감지 (Dirty Checking)

→ 수정된 엔티티를 쓰기 지연 SQL 저장소에 등록

→ 쓰기 지연 SQL 저장소의 쿼리를 데이터베이스에 전송 (등록, 수정, 삭제 쿼리)

## 영속성 컨텍스트를 플러시하는 방법

- `em.flush()` - 직접 호출
- 트랜잭션 커밋 - 플러시 자동 호출
- JPQL 쿼리 실행 - 플리시 자동 호출
    - JPQL은 그냥 SQL로 번역되어서 요청이 되기 때문에 JPA로 작업 중이던 데이터들이 조회가 안될 수 있다. 그렇기 때문에 JPA가 알아서 JPQL 쿼리 실행 전에 플러시를 호출한다

## 플러시 모드

- `FlushModeType.AUTO)` : 커밋이나 쿼리를 실행할 때 플러시 (기본값)
- `FlushModeType.COMMIT` : 커밋할 때만 플러시

<br/>

--- 

<br/>

출처
- [자바 ORM 표준 JPA 프로그래밍 - 기본편](https://www.inflearn.com/course/ORM-JPA-Basic/dashboard)